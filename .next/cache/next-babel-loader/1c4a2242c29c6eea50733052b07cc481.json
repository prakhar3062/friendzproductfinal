{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\n\nvar _this = this;\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Box, Button, Card, Container, Grid, CardContent, Typography } from \"@material-ui/core\";\nimport ImageGallery from \"react-image-gallery\";\nimport FavoriteIcon from \"@material-ui/icons/Favorite\";\nimport FavoriteBorderIcon from \"@material-ui/icons/FavoriteBorder\";\nimport ShareOutlinedIcon from \"@material-ui/icons/ShareOutlined\";\nimport { commonStyles, desktopStyles, mobileStyles } from \"./styles\";\nimport Link from \"next/link\";\nimport { useSelector } from \"react-redux\";\nimport { useDispatch } from \"react-redux\";\nimport store from \"../../redux/store\";\nimport Router from \"next/router\";\nimport { useRouter } from \"next/router\"; // import { chatDialog } from \"../../redux/actions/dialog\";\n\nimport ConnectyCube from \"connectycube\";\nimport { DeleteEvent, Favourite } from \"../../apis/auth-api\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport MuiAlert from \"@material-ui/lab/Alert\";\nimport { authenticated } from \"../../redux/actions/auth\";\nimport ShareIcon from \"../ShareIcon\";\n\nfunction Alert(props) {\n  return __jsx(MuiAlert, _extends({\n    elevation: 6,\n    variant: \"filled\"\n  }, props));\n}\n\nvar useStyles = makeStyles(function (theme) {\n  var _objectSpread2;\n\n  return _objectSpread(_objectSpread({}, commonStyles), {}, (_objectSpread2 = {}, _defineProperty(_objectSpread2, theme.breakpoints.up(\"md\"), desktopStyles), _defineProperty(_objectSpread2, theme.breakpoints.down(\"sm\"), mobileStyles), _objectSpread2));\n});\n\nvar ProductDetail = function ProductDetail(_ref) {\n  var data = _ref.data;\n  var dispatch = useDispatch();\n\n  var _React$useState = React.useState(0),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      isSaved = _React$useState2[0],\n      setisSaved = _React$useState2[1];\n\n  var _useState = useState({}),\n      product = _useState[0],\n      setproduct = _useState[1];\n\n  var _useState2 = useState([]),\n      images = _useState2[0],\n      setimages = _useState2[1];\n\n  var _useState3 = useState(false),\n      showVideo = _useState3[0],\n      setshowVideo = _useState3[1];\n\n  var userFavProducts = useSelector(function (state) {\n    return state.auth_user.userFavProducts;\n  });\n  var accessToken = useSelector(function (state) {\n    return state.auth_user.accessToken;\n  });\n  var user = useSelector(function (state) {\n    return state.auth_user.user.id;\n  });\n  var userdetail = useSelector(function (state) {\n    return state.auth_user.user;\n  });\n\n  var _React$useState3 = React.useState(false),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      snackbar = _React$useState4[0],\n      setsnackbar = _React$useState4[1];\n\n  var _React$useState5 = React.useState(\"\"),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      snackbarMsg = _React$useState6[0],\n      setsnackbarMsg = _React$useState6[1];\n\n  var _React$useState7 = React.useState(\"success\"),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      snackbarType = _React$useState8[0],\n      setsnackbarType = _React$useState8[1];\n\n  var router = useRouter();\n  var staticImages = [{\n    original: \"/static/images/bike1.jpg\",\n    thumbnail: \"/static/images/bike1.jpg\",\n    embedUrl: \"https://www.youtube.com/embed/4pSzhZ76GdM?autoplay=1&showinfo=0\",\n    renderItem: _renderVideo.bind(_this)\n  }, {\n    original: \"/static/images/bike2.jpg\",\n    thumbnail: \"/static/images/bike2.jpg\"\n  }, {\n    original: \"/static/images/bike3.jpg\",\n    thumbnail: \"/static/images/bike3.jpg\"\n  }, {\n    original: \"/static/images/bike4.jpg\",\n    thumbnail: \"/static/images/bike4.jpg\"\n  }];\n  useEffect(function () {\n    isFavourite();\n  }, [userFavProducts]);\n\n  var isFavourite = function isFavourite() {\n    if (userFavProducts && userFavProducts.includes(data.id)) {\n      console.log(userFavProducts, userFavProducts.includes(data.id));\n      setisSaved(1);\n    }\n  };\n\n  var changeRating = function changeRating() {\n    console.log(\"clk\");\n\n    if (!accessToken || accessToken == \"\") {\n      window.location.replace(\"/?signup=open\");\n    }\n\n    if (!isSaved) {\n      Favourite({\n        type_id: data.id,\n        type: \"product\",\n        user_id: user,\n        action: \"add\"\n      }).then(function (response) {\n        if (response.error) {\n          setsnackbar(true);\n          setsnackbarMsg(\"There is some error.Please try again later\");\n          setsnackbarType(\"error\");\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents, response.body.favProducts));\n        } else {\n          setsnackbar(true);\n          setsnackbarMsg(\"Added to favourites\");\n          setsnackbarType(\"success\");\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents, response.body.favProducts));\n        }\n      });\n      setisSaved(!isSaved);\n    } else {\n      Favourite({\n        type_id: data.id,\n        type: \"product\",\n        user_id: user,\n        action: \"remove\"\n      }).then(function (response) {\n        if (response.error) {\n          setsnackbar(true);\n          setsnackbarMsg(\"There is some error.Please try again later\");\n          setsnackbarType(\"error\");\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents, response.body.favProducts));\n        } else {\n          setsnackbar(true);\n          setsnackbarMsg(\"Removed from favourites\");\n          setsnackbarType(\"success\");\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents, response.body.favProducts));\n        }\n      });\n      setisSaved(!isSaved);\n    }\n  };\n\n  var handlesnackbar = function handlesnackbar() {\n    setsnackbar(!snackbar);\n  };\n\n  function _renderVideo(item) {\n    return __jsx(\"div\", {\n      className: \"video-wrapper\"\n    }, __jsx(\"video\", {\n      width: \"560\",\n      height: \"315\",\n      controls: true\n    }, __jsx(\"source\", {\n      src: item.embedUrl,\n      type: \"video/mp4\"\n    })));\n  }\n\n  var _toggleShowVideo = function _toggleShowVideo(url) {\n    setshowVideo(!showVideo);\n  }; // function _resetVideo(index) {\n  //   setshowVideo(false)\n  //   console.debug('slid to index', index);\n  // }\n  // function _onSlide() {\n  //   _resetVideo();\n  // }\n\n\n  useEffect(function () {\n    setproduct(data);\n\n    if (data.images) {\n      var imgArr = [];\n      var self = _this;\n      data.images.map(function (item) {\n        if (item.type == \"video\") {\n          imgArr.push({\n            original: item.thumbnail_link,\n            thumbnail: item.thumbnail_link,\n            embedUrl: item.link,\n            renderItem: _renderVideo.bind(self)\n          });\n        } else {\n          imgArr.push({\n            original: item.link,\n            thumbnail: item.thumbnail_link\n          });\n        }\n      });\n      setimages(imgArr);\n    } // setproducts(data);\n\n  }, [data]);\n\n  function renderLeftNav(onClick, disabled) {\n    return __jsx(\"button\", {\n      type: \"button\",\n      className: \"image-gallery-left-nav\",\n      \"aria-label\": \"Prev Slide\",\n      disabled: disabled,\n      onClick: onClick\n    }, __jsx(FaArrowLeft, {\n      size: 30,\n      color: \"#000\"\n    }));\n  }\n\n  function renderRightNav(onClick, disabled) {\n    return __jsx(\"button\", {\n      type: \"button\",\n      className: \"image-gallery-right-nav\",\n      \"aria-label\": \"Next Slide\",\n      disabled: disabled,\n      onClick: onClick\n    }, __jsx(FaArrowRight, {\n      size: 30,\n      color: \"#000\"\n    }));\n  }\n\n  var authUser = useSelector(function (state) {\n    return state.auth_user;\n  });\n\n  function handleChatBtn() {\n    if (!authUser.user) {\n      window.location.replace(\"/?signup=open\");\n      return;\n    } // if (!authUser.user.connectycube_user) {\n    //   window.location.replace(\"/?signup=open\");\n    //   return;\n    // }\n\n\n    Router.push(\"/chat/product/\" + data.id);\n  } // function handleChatBtn() {\n  //   let dialog_id = \"product_4\"\n  //   // let dialog_id = \"product_\" + data.id\n  //   if (!authUser.user.connectycube_user) {\n  //     alert(\"please Login First\");\n  //     return;\n  //   }\n  //   let params = {\n  //     search_text: dialog_id,\n  //     // search_text: dialog_id,\n  //     limit: 1\n  //   }\n  //   // search\n  //   ConnectyCube.chat\n  //     .search(params)\n  //     .then(result => {\n  //       console.log(result)\n  //       if (result.dialogs && result.dialogs.length) {\n  //         let dialog = result.dialogs[0]\n  //         if (dialog.name == dialog_id) {\n  //           return\n  //         }\n  //       }\n  //       let params = {\n  //         type: 2,\n  //         occupants_ids: [\n  //           authUser.user.connectycube_user.connectycube_id,\n  //           data.seller.connectycube_user.connectycube_id,\n  //         ],\n  //         name: dialog_id\n  //       };\n  //       // JS SDK v2\n  //       ConnectyCube.chat.dialog\n  //         .create(params)\n  //         .then((dialog) => {\n  //           // store.dispatch(chatDialog(dialog));\n  //           Router.push(\"/chat\");\n  //         })\n  //     })\n  //     .catch(error => {\n  //       console.log(error)\n  //       alert('Oops!! there was some problem while connecting.')\n  //     });\n  // }\n\n\n  var classes = useStyles();\n  if (!data || !data.seller) return null;\n  console.log(\"data\", data);\n  return __jsx(\"section\", {\n    className: classes.section\n  }, __jsx(Container, {\n    maxWidth: \"xl\"\n  }, __jsx(Grid, {\n    container: true\n  }, __jsx(Grid, {\n    item: true,\n    lg: 12,\n    md: 12,\n    sm: 12,\n    xs: 12,\n    className: classes.grid\n  }, __jsx(Snackbar, {\n    open: snackbar,\n    autoHideDuration: 6000,\n    onClose: handlesnackbar\n  }, __jsx(Alert, {\n    onClose: handlesnackbar,\n    severity: snackbarType\n  }, snackbarMsg)), __jsx(Card, {\n    className: \"\".concat(classes.card, \" \").concat(classes.spanCol4, \" \").concat(classes.spanRow2)\n  }, __jsx(CardContent, {\n    className: classes.cardBody\n  }, __jsx(\"div\", {\n    className: classes.Gallery\n  }, __jsx(ImageGallery, {\n    items: images // onSlide={_onSlide.bind(this)}\n    ,\n    showPlayButton: false,\n    showFullscreenButton: false,\n    showGalleryPlayButton: true\n  })))), __jsx(Card, {\n    className: \"\".concat(classes.card, \" \").concat(classes.spanCol2)\n  }, __jsx(CardContent, {\n    className: classes.cardInnerBody\n  }, __jsx(\"div\", {\n    className: classes.Left\n  }, __jsx(Box, {\n    className: classes.box\n  }, __jsx(Typography, {\n    className: classes.heading\n  }, \"Title\"), __jsx(Typography, {\n    variant: \"h6\"\n  }, data.title)), __jsx(Box, {\n    className: classes.box\n  }, __jsx(Typography, {\n    className: classes.heading\n  }, \"College Name\"), __jsx(Typography, {\n    variant: \"h6\"\n  }, data.university ? data.university.name : \"\")), __jsx(Box, {\n    className: classes.Pricebox\n  }, __jsx(Typography, {\n    className: classes.heading\n  }, \"Price\"), data.type == \"Rental\" && __jsx(Typography, {\n    variant: \"h4\",\n    color: \"primary\"\n  }, data.price, \" /\", data.time_period ? data.time_period : \"month\"), data.type != \"Rental\" && __jsx(Typography, {\n    variant: \"h4\",\n    color: \"primary\"\n  }, \"\\u20B9\", data.price))), __jsx(\"div\", {\n    className: classes.Right\n  }, isSaved ? __jsx(FavoriteIcon, {\n    style: {\n      color: \"var(--theme)\"\n    },\n    onClick: changeRating,\n    id: data.id\n  }) : __jsx(FavoriteBorderIcon, {\n    style: {\n      color: \"var(--theme)\"\n    },\n    onClick: changeRating,\n    id: data.id\n  }), __jsx(ShareIcon, {\n    title: data.title,\n    url: \"\".concat(process.env.APP_URL).concat(router.asPath)\n  })))), __jsx(Card, {\n    className: \"\".concat(classes.card, \" \").concat(classes.SellerCard, \" \").concat(classes.spanCol2)\n  }, __jsx(CardContent, {\n    className: classes.cardInner\n  }, __jsx(\"div\", {\n    className: classes.cardHead\n  }, __jsx(\"div\", {\n    className: classes.sellerImg\n  }, __jsx(\"img\", {\n    src: data.seller.profile_img ? data.seller.profile_img : \"/static/images/placeholder.jpg\"\n  })), __jsx(\"div\", {\n    className: classes.sellerDetails\n  }, __jsx(Box, {\n    className: classes.box\n  }, __jsx(Typography, {\n    className: classes.heading\n  }, \"Seller Name\"), __jsx(Typography, {\n    variant: \"h6\"\n  }, data.seller ? \"\".concat(data.seller.first_name, \" \").concat(data.seller.last_name) : \"\")), __jsx(Box, {\n    className: classes.box\n  }, __jsx(Typography, {\n    className: classes.heading\n  }, \"Seller Location\"), __jsx(Typography, {\n    variant: \"h6\"\n  }, data.seller && data.seller.university ? data.seller.university.name : \"\")))), __jsx(\"div\", {\n    className: classes.cardAction\n  }, __jsx(Button, {\n    className: classes.primaryBtn,\n    onClick: handleChatBtn,\n    disabled: data.seller.id == user\n  }, \"Chat With Seller\"), __jsx(Link, {\n    href: \"/profile/\".concat(data.seller.id) // as={`/profile/${data.seller.id}`}\n\n  }, __jsx(Button, {\n    className: classes.secondaryBtn\n  }, \"Check Seller Profile\"))))), __jsx(Card, {\n    className: \"\".concat(classes.card, \" \").concat(classes.spanCol6)\n  }, __jsx(CardContent, {\n    className: classes.cardBody\n  }, __jsx(Typography, {\n    className: classes.heading\n  }, \"Description\"), data.type == \"Rental\" && __jsx(Typography, {\n    className: classes.heading\n  }, data.type, \" - per\", \" \", data.time_period ? data.time_period : \"month\"), __jsx(Typography, {\n    className: classes.paragraph\n  }, data.description)))))));\n};\n\nexport default ProductDetail;","map":null,"metadata":{},"sourceType":"module"}