{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Layout from \"./../../src/Layout\";\nimport Accordian from \"./../../src/components/Accordian\";\nimport { Backdrop, Box, Button, Container, Grid, Typography } from \"@material-ui/core\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport StickyBox from \"react-sticky-box\";\nimport { commonStyles, desktopStyles, mobileStyles, TabStyles } from \"./../../src/styles\";\nimport { getAllBuyRequests } from \"./../../src/apis/global-api\";\nimport { useSelector } from \"react-redux\";\nimport Router from \"next/router\";\nimport Sidebar from \"./../../src/components/Sidebar\";\n\nBuyRequest.getInitialProps = function (_ref) {\n  var query = _ref.query;\n  return {\n    query: query\n  };\n};\n\nvar useStyles = makeStyles(function (theme) {\n  var _objectSpread2;\n\n  return _objectSpread(_objectSpread({\n    root: {\n      width: \"100%\",\n      marginTop: '1.5rem'\n    },\n    heading: {\n      fontSize: theme.typography.pxToRem(15),\n      flexBasis: \"33.33%\",\n      flexShrink: 0\n    },\n    secondaryHeading: {\n      fontSize: theme.typography.pxToRem(15),\n      color: theme.palette.text.secondary\n    }\n  }, commonStyles), {}, (_objectSpread2 = {}, _defineProperty(_objectSpread2, theme.breakpoints.up(\"md\"), desktopStyles), _defineProperty(_objectSpread2, theme.breakpoints.between(\"sm\", \"md\"), TabStyles), _defineProperty(_objectSpread2, theme.breakpoints.down(\"sm\"), mobileStyles), _objectSpread2));\n});\nexport default function BuyRequest(_ref2) {\n  var query = _ref2.query;\n  var user = useSelector(function (state) {\n    return state.auth_user.user;\n  });\n  var classes = useStyles();\n\n  var _useState = useState(false),\n      expanded = _useState[0],\n      setExpanded = _useState[1];\n\n  var _useState2 = useState({}),\n      requests = _useState2[0],\n      setrequests = _useState2[1];\n\n  var _useState3 = useState(false),\n      loadMore = _useState3[0],\n      setloadMore = _useState3[1];\n\n  var _useState4 = useState(false),\n      lastPage = _useState4[0],\n      setlastPage = _useState4[1];\n\n  var _useState5 = useState(0),\n      page = _useState5[0],\n      setpage = _useState5[1];\n\n  var _useState6 = useState(true),\n      loading = _useState6[0],\n      setloading = _useState6[1];\n\n  useEffect(function () {\n    // const { m_uni } = query;\n    // console.log(\"queryrequest\", m_uni);\n    // if (m_uni) {\n    //   setselectedUni(m_uni);\n    // }\n    getProductRequest();\n  }, [query]);\n\n  var handleAddProduct = function handleAddProduct() {\n    if (user.id) {\n      Router.push(\"/post/request\");\n    } else {\n      window.location.replace(\"/?signup=open\");\n    }\n  };\n\n  var getProductRequest = function getProductRequest(page) {\n    page = !page ? 1 : page + 1;\n    setpage(page);\n    var url = \"&page=\".concat(page);\n    var m_uni = query.m_uni;\n\n    if (m_uni) {\n      url = url + \"&m_uni=\" + m_uni;\n    }\n\n    console.log(\"queryrequesturl\", url);\n    getAllBuyRequests(url).then(function (data) {\n      setloading(false);\n\n      if (requests && requests.data) {\n        data.data = requests.data.concat(data.data);\n      }\n\n      if (data) {\n        setrequests(data);\n      }\n\n      if (data && data.current_page == data.last_page) {\n        setlastPage(true);\n      }\n\n      setloadMore(false); // setrequests(data)\n      // if (data && data.current_page == data.last_page) {\n      //   setlastPage(true);\n      // } else {\n      //   setlastPage(false);\n      // }\n    });\n  };\n\n  var handleButtonClick = function handleButtonClick() {\n    if (!loadMore) {\n      setloadMore(true);\n      getProductRequest(page); // timer.current = setTimeout(() => {\n      //   setLoading(false);\n      // }, 2000);\n    }\n  };\n\n  var handleChange = function handleChange(panel) {\n    return function (event, isExpanded) {\n      setExpanded(isExpanded ? panel : false);\n    };\n  };\n\n  return __jsx(Layout, null, __jsx(\"section\", {\n    className: classes.section\n  }, __jsx(Container, {\n    maxWidth: \"xl\"\n  }, __jsx(Grid, {\n    container: true\n  }, __jsx(Grid, {\n    item: true,\n    lg: 12,\n    md: 12,\n    sm: 12,\n    xs: 12\n  }, __jsx(Box, {\n    className: classes.productsHeader\n  }, __jsx(Typography, {\n    variant: \"h3\"\n  }, \"Buy Requests\"), __jsx(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    onClick: handleAddProduct\n  }, \"Add Request\"))), __jsx(Grid, {\n    item: true,\n    lg: 3,\n    md: 3,\n    sm: 12,\n    xs: 12\n  }, __jsx(StickyBox, {\n    offsetTop: 100,\n    offsetBottom: 20\n  }, __jsx(Sidebar, {\n    type: \"requests\",\n    query: query\n  }))), __jsx(Grid, {\n    item: true,\n    lg: 9,\n    md: 9,\n    sm: 12,\n    xs: 12\n  }, __jsx(Box, null, loading && __jsx(Backdrop, {\n    className: classes.backdrop,\n    open: loading // onClick={handleClose}\n\n  }, __jsx(CircularProgress, {\n    color: \"inherit\"\n  })), __jsx(\"div\", {\n    className: classes.root\n  }, requests && requests.data && requests.data.length > 0 && requests.data.map(function (data) {\n    return __jsx(Accordian, {\n      data: data,\n      isAuthUser: data.user_id == user.id,\n      key: data.id\n    });\n  })), requests.data && requests.data.length <= 0 && __jsx(Typography, {\n    variant: \"h4\"\n  }, \"No product request for now\")), requests.data && requests.data.length > 0 && !lastPage && __jsx(\"div\", {\n    className: classes.loadMorewrapper\n  }, __jsx(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    className: classes.loadMore,\n    disabled: loadMore,\n    onClick: handleButtonClick\n  }, \"Load More\"), loadMore && __jsx(CircularProgress, {\n    size: 24,\n    className: classes.buttonProgress\n  })))))));\n}","map":null,"metadata":{},"sourceType":"module"}