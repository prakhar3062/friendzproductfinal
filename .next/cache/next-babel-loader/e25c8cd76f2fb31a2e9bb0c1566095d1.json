{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React, { useEffect } from \"react\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Card, CardContent, Typography, Link } from '@material-ui/core';\nimport StarRatings from 'react-star-ratings';\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\nimport Button from \"@material-ui/core/Button\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport MuiAlert from \"@material-ui/lab/Alert\";\nimport { DeleteEvent, Favourite } from \"../../apis/auth-api\";\nimport { useRouter } from \"next/router\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { commonStyles, desktopStyles, mobileStyles, TabStyles } from './styles';\nimport { authenticated } from \"../../redux/actions/auth\";\nimport FavoriteIcon from '@material-ui/icons/Favorite';\nimport FavoriteBorderIcon from '@material-ui/icons/FavoriteBorder';\nconst API_HOST = process.env.API_HOST;\n\nfunction Alert(props) {\n  return __jsx(MuiAlert, _extends({\n    elevation: 6,\n    variant: \"filled\"\n  }, props));\n}\n\nconst useStyles = makeStyles(theme => _objectSpread(_objectSpread({}, commonStyles), {}, {\n  [theme.breakpoints.up('sm')]: desktopStyles,\n  [theme.breakpoints.between('xs', 'sm')]: TabStyles,\n  [theme.breakpoints.down('xs')]: mobileStyles\n}));\n\nfunction EventCard({\n  data,\n  isAuthUser = false,\n  showState = false\n}) {\n  const dispatch = useDispatch();\n  const [isSaved, setisSaved] = React.useState(data.saved);\n  const [eventStar, seteventStar] = React.useState(isSaved ? 1 : 0);\n  const [snackbar, setsnackbar] = React.useState(false);\n  const [snackbarMsg, setsnackbarMsg] = React.useState(\"\");\n  const [snackbarType, setsnackbarType] = React.useState(\"success\");\n  const user = useSelector(state => state.auth_user.user.id);\n  const userFavEvents = useSelector(state => state.auth_user.userFavEvents);\n  const accessToken = useSelector(state => state.auth_user.accessToken);\n  const userdetail = useSelector(state => state.auth_user.user);\n  useEffect(() => {\n    isFavourite();\n  }, [userFavEvents]);\n  const router = useRouter();\n  const favPage = router.pathname.search('favourite') == -1 ? false : true;\n  const classes = useStyles();\n\n  const isFavourite = () => {\n    if (userFavEvents && userFavEvents.includes(data.id)) {\n      console.log(userFavEvents, userFavEvents.includes(data.id));\n      setisSaved(1);\n      seteventStar(1);\n    }\n  };\n\n  const changeRating = () => {\n    console.log('clk');\n\n    if (!accessToken || accessToken == '') {\n      window.location.replace(\"/?signup=open\");\n    }\n\n    if (!isSaved && eventStar == 0) {\n      Favourite({\n        'type_id': data.id,\n        type: 'event',\n        'user_id': user,\n        'action': 'add'\n      }).then(response => {\n        if (response.error) {\n          setsnackbar(true);\n          setsnackbarMsg(\"There is some error.Please try again later\");\n          setsnackbarType(\"error\");\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents, response.body.favProducts));\n        } else {\n          setsnackbar(true);\n          setsnackbarMsg(\"Added to favourites\");\n          setsnackbarType(\"success\");\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents, response.body.favProducts));\n        }\n      });\n      seteventStar(1);\n      setisSaved(!isSaved);\n    } else {\n      Favourite({\n        'type_id': data.id,\n        type: 'event',\n        'user_id': user,\n        'action': 'remove'\n      }).then(response => {\n        if (response.error) {\n          setsnackbar(true);\n          setsnackbarMsg(\"There is some error.Please try again later\");\n          setsnackbarType(\"error\");\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents, response.body.favProducts));\n        } else {\n          setsnackbar(true);\n          setsnackbarMsg(\"Removed from favourites\");\n          setsnackbarType(\"success\");\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents, response.body.favProducts));\n\n          if (favPage) {\n            document.getElementById('card_' + data.id).parentElement.remove();\n          }\n        }\n      });\n      seteventStar(0);\n      setisSaved(!isSaved);\n    }\n  };\n\n  const [anchorEl, setAnchorEl] = React.useState(null);\n\n  const handleClick = event => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  const handleEdit = () => {\n    router.push(\"/post/event/edit/\" + data.id);\n  };\n\n  const handleDelete = () => {\n    DeleteEvent(data, data.id).then(response => {\n      if (response.error) {\n        setsnackbar(true);\n        setsnackbarMsg(\"There is some error.Please try again later\");\n        setsnackbarType(\"error\");\n      } else {\n        setsnackbar(true);\n        setsnackbarMsg(\"Deleted\");\n        setsnackbarType(\"success\");\n        location.reload();\n      }\n    });\n  };\n\n  const handlesnackbar = () => {\n    setsnackbar(!snackbar);\n  };\n\n  return __jsx(Card, {\n    className: `${classes.card} event__card`,\n    id: \"card_\" + data.id\n  }, data.images.length > 0 && __jsx(Link, {\n    href: `/events/item/${data.id}`\n  }, __jsx(\"img\", {\n    src: `${API_HOST}/generate-thumb/220/300/${data.images[0].absolute_path}`,\n    alt: \"\",\n    className: classes.image\n  })), __jsx(CardContent, {\n    className: isSaved ? `${classes.cardInner} ${classes.Orangecard} ` : `${classes.cardInner}`\n  }, __jsx(Snackbar, {\n    open: snackbar,\n    autoHideDuration: 6000,\n    onClose: handlesnackbar\n  }, __jsx(Alert, {\n    onClose: handlesnackbar,\n    severity: snackbarType\n  }, snackbarMsg)), __jsx(\"div\", {\n    className: classes.flex\n  }, __jsx(Typography, {\n    variant: \"h6\",\n    className: classes.title\n  }, data.title.length >= 25 && __jsx(Link, {\n    href: `/events/item/${data.id}`\n  }, data.title.substring(0, 25) + \"...\", \" \"), data.title.length < 25 && __jsx(Link, {\n    href: `/events/item/${data.id}`\n  }, data.title)), isAuthUser && __jsx(\"div\", null, __jsx(MoreVertIcon, {\n    \"aria-controls\": \"simple-menu\",\n    \"aria-haspopup\": \"true\",\n    onClick: handleClick\n  }), __jsx(Menu, {\n    id: \"simple-menu\",\n    anchorEl: anchorEl,\n    keepMounted: true,\n    open: Boolean(anchorEl),\n    onClose: handleClose\n  }, __jsx(MenuItem, {\n    onClick: handleEdit\n  }, \"Edit\"), __jsx(MenuItem, {\n    onClick: handleDelete\n  }, \"Delete\"))), !isAuthUser && isSaved ? __jsx(FavoriteIcon, {\n    style: {\n      color: 'var(--theme)'\n    },\n    onClick: changeRating,\n    id: data.id\n  }) : __jsx(FavoriteBorderIcon, {\n    style: {\n      color: 'var(--theme)'\n    },\n    onClick: changeRating,\n    id: data.id\n  })), isAuthUser ? data.active ? __jsx(Typography, {\n    color: \"success\",\n    variant: \"h6\",\n    className: classes.date\n  }, \"Active\") : __jsx(Typography, {\n    color: \"error\",\n    variant: \"h6\",\n    className: classes.date\n  }, \"Inactive\") : '', __jsx(\"div\", {\n    className: classes.flex\n  }, __jsx(Typography, {\n    className: classes.date\n  }, data.event_date)), __jsx(\"div\", {\n    className: classes.cardBody\n  }, data.university.name.length >= 25 && __jsx(Typography, {\n    className: classes.college\n  }, data.university.name.substring(0, 25) + \"...\", \" \"), data.university.name.length < 25 && __jsx(Typography, {\n    className: classes.college\n  }, data.university.name))));\n}\n\nexport default EventCard;","map":null,"metadata":{},"sourceType":"module"}