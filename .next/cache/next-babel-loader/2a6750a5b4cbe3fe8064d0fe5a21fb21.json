{"ast":null,"code":"var _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { Component, useState, useEffect } from \"react\";\nimport Products from \"../src/containers/products\";\nimport fetch from \"node-fetch\";\nimport { useSelector } from \"react-redux\";\nimport Modal from \"./../../src/components/\";\nimport { SELECTED_FILTER_RESET, SELECTED_FILTER_UNIVERSITY } from \"../src/constants\";\n\nfunction ProductsPage(_ref) {\n  _s();\n\n  var query = _ref.query;\n  var user = useSelector(function (state) {\n    return state.auth_user.user;\n  });\n\n  var _useState = useState(false),\n      open = _useState[0],\n      setopen = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      url = _useState2[0],\n      seturl = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      m_uni = _useState3[0],\n      setm_uni = _useState3[1];\n\n  useEffect(function () {\n    setQuery(query); // setModalStatus(query)\n  }, [query]); // const setModalStatus = (query) => {\n  //   const { m_uni } = query;\n  //   console.log('testttt', !m_uni)\n  //   console.log('testttt', !user, user)\n  // }\n\n  var setQuery = function setQuery(query) {\n    var s = query.s,\n        m_city = query.m_city,\n        m_cat = query.m_cat,\n        m_uni = query.m_uni,\n        type = query.type;\n    var url = s ? \"?s=\".concat(s, \"&paginate=12\") : \"?paginate=12\";\n    var data = localStorage.getItem(SELECTED_FILTER_UNIVERSITY);\n    var selection_reset = localStorage.getItem(SELECTED_FILTER_RESET);\n    data = data && JSON.parse(data) ? JSON.parse(data).response : \"\";\n\n    if (!m_uni && data && data.length) {\n      m_uni = !selection_reset ? data[0].name : m_uni;\n    } else if (!m_uni && !user.id) {\n      setopen(true);\n    } else if (!m_uni && user.university && user.university.name) {\n      m_uni = !selection_reset ? user.university.name : m_uni;\n    }\n\n    setm_uni(m_uni);\n\n    if (m_city) {\n      url = url + \"&m_city=\" + m_city;\n    }\n\n    if (m_cat) {\n      url = url + \"&m_cat=\" + m_cat;\n    }\n\n    if (m_uni) {\n      url = url + \"&m_uni=\" + m_uni;\n    } //  else if (user && user.university) {\n    //   url = url + '&m_uni=' + user.university.name\n    // }\n\n\n    if (type) {\n      url = url + \"&type=\" + type;\n    }\n\n    seturl(url);\n  };\n\n  return __jsx(\"div\", null, open && __jsx(Modal, {\n    openStatus: open\n  }), __jsx(Products, {\n    url: url,\n    m_uni: m_uni,\n    query: query\n  }));\n}\n\n_s(ProductsPage, \"3UV+r0fRSGwKLdA1MQ5CWljWEgE=\", false, function () {\n  return [useSelector];\n});\n\n_c = ProductsPage;\n\nProductsPage.getInitialProps = function (_ref2) {\n  var query = _ref2.query;\n  return {\n    query: query\n  };\n};\n\nexport default ProductsPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductsPage\");","map":{"version":3,"sources":["E:/jay/frontend/src/pages/products.js"],"names":["React","Component","useState","useEffect","Products","fetch","useSelector","Modal","SELECTED_FILTER_RESET","SELECTED_FILTER_UNIVERSITY","ProductsPage","query","user","state","auth_user","open","setopen","url","seturl","m_uni","setm_uni","setQuery","s","m_city","m_cat","type","data","localStorage","getItem","selection_reset","JSON","parse","response","length","name","id","university","getInitialProps"],"mappings":"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","sourcesContent":["import React, { Component, useState, useEffect } from \"react\";\r\nimport Products from \"../src/containers/products\";\r\nimport fetch from \"node-fetch\";\r\nimport { useSelector } from \"react-redux\";\r\nimport Modal from \"./../../src/components/\";\r\nimport {\r\n  SELECTED_FILTER_RESET,\r\n  SELECTED_FILTER_UNIVERSITY,\r\n} from \"../src/constants\";\r\n\r\nfunction ProductsPage({ query }) {\r\n  const user = useSelector((state) => state.auth_user.user);\r\n  const [open, setopen] = useState(false);\r\n  const [url, seturl] = useState(\"\");\r\n  const [m_uni, setm_uni] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    setQuery(query);\r\n    // setModalStatus(query)\r\n  }, [query]);\r\n\r\n  // const setModalStatus = (query) => {\r\n  //   const { m_uni } = query;\r\n  //   console.log('testttt', !m_uni)\r\n  //   console.log('testttt', !user, user)\r\n\r\n  // }\r\n\r\n  const setQuery = (query) => {\r\n    let { s, m_city, m_cat, m_uni, type } = query;\r\n\r\n    let url = s ? `?s=${s}&paginate=12` : \"?paginate=12\";\r\n\r\n    let data = localStorage.getItem(SELECTED_FILTER_UNIVERSITY);\r\n    let selection_reset = localStorage.getItem(SELECTED_FILTER_RESET);\r\n    data = data && JSON.parse(data) ? JSON.parse(data).response : \"\";\r\n\r\n    if (!m_uni && data && data.length) {\r\n      m_uni = !selection_reset ? data[0].name : m_uni;\r\n    } else if (!m_uni && !user.id) {\r\n      setopen(true);\r\n    } else if (!m_uni && user.university && user.university.name) {\r\n      m_uni = !selection_reset ? user.university.name : m_uni;\r\n    }\r\n    setm_uni(m_uni);\r\n\r\n    if (m_city) {\r\n      url = url + \"&m_city=\" + m_city;\r\n    }\r\n    if (m_cat) {\r\n      url = url + \"&m_cat=\" + m_cat;\r\n    }\r\n    if (m_uni) {\r\n      url = url + \"&m_uni=\" + m_uni;\r\n    }\r\n    //  else if (user && user.university) {\r\n    //   url = url + '&m_uni=' + user.university.name\r\n    // }\r\n    if (type) {\r\n      url = url + \"&type=\" + type;\r\n    }\r\n    seturl(url);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {open && <Modal openStatus={open} />}\r\n      <Products url={url} m_uni={m_uni} query={query} />\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\nProductsPage.getInitialProps = ({ query }) => {\r\n  return { query };\r\n};\r\nexport default ProductsPage;\r\n"]},"metadata":{},"sourceType":"module"}