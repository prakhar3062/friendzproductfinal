{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Layout from \"../Layout\";\nimport { Box, Button, Container, Grid, Typography } from \"@material-ui/core\";\nimport EventCard from \"../components/EventCard\";\nimport Sidebar from \"../components/Sidebar\";\nimport Advertisement from \"../components/Advertisement\"; // import CardHorizontal from \"../components/CardHorizontal\";\n\nimport Testimonial from \"../components/Testimonial\";\nimport TuneIcon from \"@material-ui/icons/Tune\";\nimport useMediaQuery from \"@material-ui/core/useMediaQuery\";\nimport { OurConceptData, TestimonialData } from \"../utils\";\nimport StickyBox from \"react-sticky-box\";\nimport { commonStyles, desktopStyles, mobileStyles, TabStyles } from \"../styles\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\n\nvar fetch = require(\"node-fetch\");\n\nvar useStyles = makeStyles(function (theme) {\n  var _objectSpread2;\n\n  return _objectSpread(_objectSpread({}, commonStyles), {}, (_objectSpread2 = {}, _defineProperty(_objectSpread2, theme.breakpoints.up(\"md\"), desktopStyles), _defineProperty(_objectSpread2, theme.breakpoints.between(\"sm\", \"md\"), TabStyles), _defineProperty(_objectSpread2, theme.breakpoints.down(\"sm\"), mobileStyles), _objectSpread2));\n});\nimport { useRouter } from \"next/router\";\nimport { getEvents, getAllFeedback } from \"../apis/global-api\";\nimport { useSelector } from \"react-redux\";\n\nfunction Events(_ref) {\n  var data = _ref.data,\n      url = _ref.url,\n      _ref$showState = _ref.showState,\n      showState = _ref$showState === void 0 ? false : _ref$showState,\n      query = _ref.query;\n\n  var _useState = useState([]),\n      events = _useState[0],\n      setevents = _useState[1];\n\n  var _useState2 = useState(false),\n      loadMore = _useState2[0],\n      setloadMore = _useState2[1];\n\n  var _useState3 = useState(false),\n      lastPage = _useState3[0],\n      setlastPage = _useState3[1];\n\n  var _useState4 = useState(0),\n      page = _useState4[0],\n      setpage = _useState4[1];\n\n  var _useState5 = useState([]),\n      list_reviews = _useState5[0],\n      setlist_reviews = _useState5[1];\n\n  var _useState6 = useState([]),\n      adslist = _useState6[0],\n      setadslist = _useState6[1];\n\n  var user = useSelector(function (state) {\n    return state.auth_user.user;\n  });\n  useEffect(function () {\n    var API_URL = process.env.api_url;\n\n    function fetchAds() {\n      return _fetchAds.apply(this, arguments);\n    }\n\n    function _fetchAds() {\n      _fetchAds = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var adsres, ads;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return fetch(API_URL + \"/adverts\");\n\n              case 2:\n                adsres = _context.sent;\n                _context.next = 5;\n                return adsres.json();\n\n              case 5:\n                ads = _context.sent;\n                setadslist(ads);\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return _fetchAds.apply(this, arguments);\n    }\n\n    fetchAds();\n  }, []);\n  useEffect(function () {\n    console.log(\"url\", url);\n    if (url) fetchTypeEvents(url, 0, []);\n    getAllFeedback().then(function (data) {\n      setlist_reviews(data);\n    }); // setevents(data);\n  }, [data, url]);\n\n  var handleButtonClick = function handleButtonClick() {\n    if (!loadMore) {\n      setloadMore(true);\n      fetchTypeEvents(url, page, events); // timer.current = setTimeout(() => {\n      //   setLoading(false);\n      // }, 2000);\n    }\n  };\n\n  var fetchTypeEvents = function fetchTypeEvents(url, page, events) {\n    page = !page ? 1 : page + 1;\n    setpage(page);\n    url = \"\".concat(url, \"&page=\").concat(page);\n    getEvents(url).then(function (data) {\n      if (events && events.data) {\n        data.data = events.data.concat(data.data);\n      }\n\n      if (data) {\n        setevents(data);\n      }\n\n      if (data && data.current_page == data.last_page) {\n        setlastPage(true);\n      } // console.log(page, url, data);\n\n\n      setloadMore(false);\n    });\n  }; // console.log(events)\n\n\n  var router = useRouter();\n  var classes = useStyles();\n  var matches = useMediaQuery('(max-width:600px)');\n\n  var MobileSidebar = function MobileSidebar() {\n    var toggle = function toggle() {\n      setshowsidebar(!showsidebar);\n    };\n\n    var _React$useState = React.useState(false),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        showsidebar = _React$useState2[0],\n        setshowsidebar = _React$useState2[1];\n\n    return __jsx(React.Fragment, null, __jsx(Button, {\n      className: classes.fliterBtn,\n      onClick: toggle\n    }, __jsx(TuneIcon, null), \"Filter\"), showsidebar && __jsx(Sidebar, {\n      type: \"events\"\n    }));\n  };\n\n  var handleAddProduct = function handleAddProduct() {\n    if (user.id) {\n      router.push(\"/post/event\");\n    } else {\n      window.location.replace(\"/?signup=open\");\n    }\n  };\n\n  return __jsx(Layout, null, adslist && adslist.eventHeader && __jsx(Advertisement, {\n    adImg: adslist.eventHeader.link,\n    adlink: adslist.eventHeader.openlink\n  }), __jsx(\"section\", {\n    className: classes.section\n  }, __jsx(Container, {\n    maxWidth: \"xl\"\n  }, __jsx(Box, {\n    className: classes.productsHeader\n  }, __jsx(Typography, {\n    variant: \"h5\"\n  }, \"Events in your College\"), __jsx(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    onClick: handleAddProduct\n  }, \"Add Event\"))), __jsx(Container, {\n    maxWidth: \"xl\"\n  }, __jsx(Grid, {\n    container: true\n  }, __jsx(Grid, {\n    item: true,\n    lg: 3,\n    md: 3,\n    sm: 12,\n    xs: 12,\n    className: \"scrollarea\" // style={{ height: \"200px\", overflow: \"scroll\" }}\n\n  }, matches ? __jsx(Sidebar, {\n    showFilterBtn: \"true\",\n    query: query\n  }) : __jsx(StickyBox, {\n    offsetTop: 100,\n    offsetBottom: 20\n  }, __jsx(Sidebar, {\n    type: \"events\",\n    query: query\n  }))), __jsx(Grid, {\n    item: true,\n    lg: 9,\n    md: 9,\n    sm: 12,\n    xs: 12\n  }, __jsx(Box, {\n    className: classes.ProductsGridWrapper\n  }, events.data && events.data.length > 0 && events.data.slice(0, 8).map(function (data, index) {\n    return __jsx(React.Fragment, {\n      key: data.id\n    }, __jsx(EventCard, {\n      data: data\n    }), index == 2 && adslist && adslist.event1 && __jsx(Advertisement, {\n      adImg: adslist.event1.link,\n      adlink: adslist.event1.openlink\n    }));\n  })), events.data && events.data.length <= 0 && __jsx(Typography, {\n    variant: \"h4\"\n  }, \"Oops!! we we could not find related to your search. Please search something else\"), __jsx(Box, {\n    className: classes.ProductsGridWrapper\n  }, events.data && events.data.length > 0 && events.data.slice(8, events.data.length).map(function (data, index) {\n    return __jsx(React.Fragment, {\n      key: data.id\n    }, __jsx(EventCard, {\n      data: data\n    }), index == 2 && adslist && adslist.event2 && __jsx(Advertisement, {\n      adImg: adslist.event2.link,\n      adlink: adslist.event2.openlink\n    }));\n  })), events.data && events.data.length > 0 && !lastPage && __jsx(\"div\", {\n    className: classes.loadMorewrapper\n  }, __jsx(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    className: classes.loadMore,\n    disabled: loadMore,\n    onClick: handleButtonClick\n  }, \"Load More\"), loadMore && __jsx(CircularProgress, {\n    size: 24,\n    className: classes.buttonProgress\n  })))))), __jsx(\"section\", {\n    className: classes.section,\n    style: {\n      background: 'var(--theme-light)'\n    }\n  }, __jsx(Container, {\n    maxWidth: \"xl\"\n  }, __jsx(Box, {\n    className: classes.sectionHeader\n  }, __jsx(Typography, {\n    variant: \"h2\"\n  }, \"REVIEW\")), list_reviews && list_reviews.length > 0 && __jsx(Testimonial, {\n    data: list_reviews\n  }))));\n}\n\nexport default Events;","map":null,"metadata":{},"sourceType":"module"}